---
- name: Provision macOS
  hosts: all
  become: false
  
  roles:
    - role: common
      tags: common
      
    - role: video
      when: machine_type in ['video', 'personal']
      tags: video
      
    - role: personal
      when: machine_type == 'personal'
      tags: personal
      
    - role: family
      when: machine_type == 'family'
      tags: family

  tasks:
    - name: Check required network volumes are mounted
      include_tasks: "{{ playbook_dir }}/tasks/check_network_volumes.yml"
      vars:
        required_volumes:
          - common
          # - production  # Add more as needed
      when: machine_type in ['video', 'personal']
      tags: always