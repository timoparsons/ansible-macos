# ============================================================================
# File: tasks/backup_app.yml
# Reusable task to backup a single application
# Called by backup playbooks, not run directly
# ============================================================================
---
- name: "Backup {{ app_backup_definitions[app_key].name }}"
  block:
    - name: Set app definition
      set_fact:
        app_def: "{{ app_backup_definitions[app_key] }}"
    
    # Don't create directories here - let backup_path.yml handle it
    # based on whether the source is a file or directory
    
    - name: "Backup paths for {{ app_def.name }}"
      include_tasks: backup_path.yml
      loop: "{{ app_def.paths }}"
      loop_control:
        loop_var: path_item
        label: "{{ path_item.src }}"