# ============================================================================
# File: tasks/backup_app.yml
# Reusable task to backup a single application
# Called by backup playbooks, not run directly
# ============================================================================
---
- name: "Backup {{ app_backup_definitions[app_key].name }}"
  block:
    - name: Set app definition
      set_fact:
        app_def: "{{ app_backup_definitions[app_key] }}"

    
    - name: "Backup paths for {{ app_def.name }}"
      include_tasks: "{{ 'backup_compressed_directory.yml' if path_item.compress | default(false) else 'backup_path.yml' }}"
      loop: "{{ app_def.paths }}"
      loop_control:
        loop_var: path_item
        label: "{{ path_item.src }}"        